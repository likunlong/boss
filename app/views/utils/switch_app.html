<div class="wrapper-md">
    <div class="col-md-12">
        <div class="row row-sm text-center">
            {% for item in lists %}
            <div class="col-xs-4">
                <a href="javascript:void(0);" id="{{item['id']}}" class="block panel padder-v bg-white item btn_add">
                    <span class="thumb avatar pull-left m-t-n-sm m-b-n-sm m-l-sm">
                        <img src="{{item['icon']}}">
                    </span>
                    <span class="text-black font-thin h2 block">{{item['name']}}</span>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title" id="myModalLabel">版本</h4>
            </div>
            <div class="modal-body row">

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span>关闭</button>
            </div>
        </div>
    </div>
</div>

<script>

    $(document).ready(function() {
        $(".btn_add").click(function () {
            var gameid = $(this).attr('id');
            $.ajax({
                url:'/utils/switch_app',
                type:'POST', //GET
                async:true,    //或false,是否异步
                data:{
                    gameid:gameid,
                },
                dataType:'json',    //返回的数据格式：json/xml/html/script/jsonp/text
                success:function(respon){
                    if(respon['error'] == 0){
                        var html = '';
                        var data = respon['data'];
                        for(var i in data){
                            html += '<div class="col-xs-4"><button class="btn m-b-xs btn-success btn-rounded" id="'+ data[i]['id'] +'">' + data[i]['name'] + '</button></div>'
                        }
                        $('.modal-body').html(html);
                        $('#myModal').modal();
                    }else{
                        $('.modal-body').html('<div class="col-xs-12"><span class="text-danger">'+respon['data']+'</span></div>');
                        $('#myModal').modal();
                    }
                }
            });
        });

        $(".modal-body").on("click",'.btn-success',function(){
            var versionid = $(this).attr('id');
            $.ajax({
                url:'/utils/setgameversion',
                type:'post', //GET
                async:true,    //或false,是否异步
                data:{
                    id:versionid,
                },
                dataType:'json',    //返回的数据格式：json/xml/html/script/jsonp/text
                success:function(respon){
                    if(respon['error'] == 0){
                        $('.modal-body').html('<div class="col-xs-12"><span class="text-danger">切换版本成功</span></div>');
                        $('.btn-default').attr('id','jump');
                        $('.close').attr('id','close');
                        $('#myModal').modal();

                    }else{
                        $('.modal-body').html('<div class="col-xs-12"><span class="text-danger">'+respon['data']+'</span></div>');
                        $('#myModal').modal();
                    }
                }
            });
        });

        $("#myModal").on("click","#jump, #close",function(){
            window.location = "/";
        });
    });
</script>